---
date:
  created: 2025-11-04
draft: true
---

# **ğŸ“… SAISON B Semaine 1 Ã‰pisode 2 - Modules et Express**

## **ğŸ“š Notions du jour**

+ Les modules
+ NPM
+ `package.json`
+ Express

<!-- more -->

---

### **ğŸ§© Les Modules en JavaScript (ES6) : DÃ©couper son Code pour le Rendre Maintenable**

Aujourdâ€™hui, jâ€™ai approfondi un concept **fondamental** en Node.js (et en JavaScript moderne) : **les modules**. Le dÃ©coupage en modules permet de **structurer son code**, de le rendre **rÃ©utilisable**, et de **faciliter la collaboration**.

#### **ğŸ”§ Comment Fonctionnent les Modules ES6 ?**

En ES6 (ECMAScript 2015), on utilise :

+ **`export`** pour exposer des fonctions, variables ou classes depuis un fichier.
+ **`import`** pour les importer dans un autre fichier.

**Exemple :**

1. **Exporter une fonction depuis un fichier `math.js` :**
   ```javascript
   // math.js
   export function add(a, b) {
     return a + b;
   }

   export function subtract(a, b) {
     return a - b;
   }
   ```

2. **Importer et utiliser ces fonctions dans `index.js` :**
   ```javascript
   // index.js
   import { add, subtract } from './math.js';

   console.log(add(2, 3));      // Output: 5
   console.log(subtract(5, 2)); // Output: 3
   ```

**Variantes dâ€™export/import :**

+ **Export par dÃ©faut** (un seul par fichier) :
  ```javascript
  // math.js
  export default function multiply(a, b) {
    return a * b;
  }
  ```
  ```javascript
  // index.js
  import multiply from './math.js';
  console.log(multiply(2, 4)); // Output: 8
  ```

+ **Importer tout un module sous un alias :**
  ```javascript
  import * as math from './math.js';
  console.log(math.add(2, 3)); // Output: 5
  ```

**Pourquoi câ€™est indispensable ?**

+ **ModularitÃ©** : Chaque fichier a une responsabilitÃ© claire.
+ **RÃ©utilisabilitÃ©** : Le mÃªme code peut Ãªtre utilisÃ© dans plusieurs projets.
+ **MaintenabilitÃ©** : Plus facile Ã  tester et Ã  dÃ©boguer.

---

### **ğŸ“¦ NPM : Le Gestionnaire de Paquets de Node.js**

**NPM** (*Node Package Manager*) est un outil qui permet dâ€™**installer, gÃ©rer et partager des dÃ©pendances** pour un projet Node.js. Avec plus dâ€™un million de packages disponibles, câ€™est une **mine dâ€™or** pour les dÃ©veloppeurs !

#### **ğŸ“– CrÃ©er un Nouveau Projet Node.js**

1. **Initialiser un projet** (crÃ©er un `package.json`) :
   ```bash
   npm init -y
   ```
   - Le flag `-y` gÃ©nÃ¨re un `package.json` avec les valeurs par dÃ©faut.

2. **Structure dâ€™un `package.json` :**
   ```json
   {
     "name": "mon-projet",
     "version": "1.0.0",
     "description": "Un projet Node.js gÃ©nial",
     "main": "index.js",
     "scripts": {
       "start": "node index.js",
       "dev": "node --watch index.js"  // Relance le serveur Ã  chaque modification
     },
     "dependencies": {
       "express": "^4.18.2"  // Liste des dÃ©pendances installÃ©es
     },
     "devDependencies": {
       "nodemon": "^3.0.2"   // DÃ©pendances pour le dÃ©veloppement
     }
   }
   ```

**Explications des champs clÃ©s :**

| Champ            | RÃ´le                                                                 |
|------------------|----------------------------------------------------------------------|
| `name`           | Nom du projet.                                                       |
| `version`        | Version du projet (semantic versioning : `major.minor.patch`).      |
| `main`           | Point dâ€™entrÃ©e du projet (fichier exÃ©cutÃ© par dÃ©faut).               |
| `scripts`        | Commandes personnalisÃ©es (ex: `npm start`, `npm run dev`).          |
| `dependencies`   | Packages nÃ©cessaires pour **lâ€™exÃ©cution** du projet.                |
| `devDependencies`| Packages nÃ©cessaires pour le **dÃ©veloppement** (tests, outils).    |

#### **ğŸ“– Installer des DÃ©pendances**

1. **Installer un package (ex: Express) :**
   ```bash
   npm install express
   ```
   - Ajoute Express dans `dependencies` du `package.json`.

2. **Installer un package pour le dÃ©veloppement (ex: Nodemon) :**
   ```bash
   npm install --save-dev nodemon
   ```
   - Ajoute Nodemon dans `devDependencies`.

3. **Lancer un script personnalisÃ© :**
   ```bash
   npm run dev  # ExÃ©cute "node --watch index.js"
   ```

**Pourquoi utiliser NPM ?**

+ **Gestion des dÃ©pendances** : NPM tÃ©lÃ©charge et installe automatiquement les packages (et leurs dÃ©pendances).
+ **ReproductibilitÃ©** : Le `package.json` permet de **reconstruire lâ€™environnement** avec `npm install`.
+ **Scripts utiles** : Automatiser des tÃ¢ches (ex: lancer le serveur, exÃ©cuter des tests).

---

### **ğŸš€ Express : CrÃ©er un Serveur Web en Quelques Lignes**

**Express** est un **framework minimaliste** pour Node.js, qui simplifie la crÃ©ation de **serveurs web** et dâ€™**APIs**. Câ€™est lâ€™outil idÃ©al pour construire des applications backend rapidement.

#### **ğŸ“– Initialiser un Serveur Express**

1. **Installer Express :**
   ```bash
   npm install express
   ```

2. **CrÃ©er un serveur de base :**
   ```javascript
   // index.js
   import express from 'express';

   const app = express();
   const port = 3000;

   // DÃ©finir une route pour la page d'accueil
   app.get('/', (req, res) => {
     res.send('Hello, Express!');
   });

   // DÃ©marrer le serveur
   app.listen(port, () => {
     console.log(`Server running at http://localhost:${port}`);
   });
   ```

3. **Lancer le serveur :**
   ```bash
   npm start
   ```
   - Le serveur est accessible Ã  [http://localhost:3000](http://localhost:3000).

---
#### **ğŸ“– Dialoguer avec le Serveur : Routes et RÃ©ponses**

1. **RÃ©pondre Ã  une requÃªte GET :**
   ```javascript
   app.get('/about', (req, res) => {
     res.send('About Page');
   });
   ```
   - Accible Ã  [http://localhost:3000/about](http://localhost:3000/about).

2. **Envoyer du JSON :**
   ```javascript
   app.get('/api/data', (req, res) => {
     res.json({ message: "Hello from the API!", status: "success" });
   });
   ```
   - RÃ©pond avec un objet JSON.

3. **GÃ©rer les paramÃ¨tres dâ€™URL :**
   ```javascript
   app.get('/users/:id', (req, res) => {
     const userId = req.params.id;
     res.send(`User ID: ${userId}`);
   });
   ```
   + Exemple : [http://localhost:3000/users/123](http://localhost:3000/users/123) â†’ "User ID: 123".

4. **GÃ©rer les requÃªtes POST (avec middleware) :**
   ```javascript
   // Middleware pour parser le JSON
   app.use(express.json());

   app.post('/users', (req, res) => {
     const user = req.body;  // AccÃ¨s aux donnÃ©es envoyÃ©es en JSON
     console.log("New user:", user);
     res.status(201).send('User created!');
   });
   ```
   + Tester avec `curl` ou Postman :
     ```bash
     curl -X POST -H "Content-Type: application/json" -d '{"name":"Yoann"}' http://localhost:3000/users
     ```

---

#### **ğŸ“– Exemple Complet : Une Mini-API avec Express**

```javascript
import express from 'express';

const app = express();
const port = 3000;

// Middleware pour parser le JSON
app.use(express.json());

// Route GET
app.get('/', (req, res) => {
  res.send('Welcome to my Express server!');
});

// Route GET avec paramÃ¨tre
app.get('/greet/:name', (req, res) => {
  res.send(`Hello, ${req.params.name}!`);
});

// Route POST
app.post('/api/data', (req, res) => {
  console.log("Received data:", req.body);
  res.json({ status: "success", data: req.body });
});

// DÃ©marrer le serveur
app.listen(port, () => {
  console.log(`Server listening on port ${port}`);
});
```

**Test avec `curl` :**
```bash
# RequÃªte GET
curl http://localhost:3000/greet/Node

# RequÃªte POST
curl -X POST -H "Content-Type: application/json" -d '{"key":"value"}' http://localhost:3000/api/data
```

---

### **ğŸ’¡ Ce Que Jâ€™ai Appris Aujourdâ€™hui**

1. **Les modules ES6** permettent de **structurer et rÃ©utiliser** du code efficacement.
2. **NPM** est **indispensable** pour gÃ©rer les dÃ©pendances et automatiser des tÃ¢ches via des scripts.
3. **Express** rend la crÃ©ation dâ€™un serveur Node.js **simple et intuitive** :
   + DÃ©finir des routes (`app.get`, `app.post`).
   + RÃ©pondre aux requÃªtes (`res.send`, `res.json`).
   + Utiliser des middlewares (`app.use`).

---

## **âŒ¨ï¸ Challenge du jour : "Hit MO'chine Express" â€“ Un Site Web Basique avec Express !**

---

### **ğŸ¤ PrÃ©sentation du Challenge**

Aujourdâ€™hui, Charlu et Lili ont dÃ©cidÃ© de **passer au web** ! AprÃ¨s leur outil en ligne de commande, ils veulent un **site web basique** pour afficher leur hit-parade. Lâ€™objectif Ã©tait de crÃ©er un site avec **Express**, composÃ© de 3 pages (et quelques bonus).

**FonctionnalitÃ©s demandÃ©es :**

1. **Page dâ€™accueil (`/`)** : Affiche un message dâ€™accueil.
2. **Page de classement (`/classement`)** : Affiche le top 10 du hit-parade.
3. **Page de statistiques (`/stats`)** : Affiche le nombre de visites de la page dâ€™accueil.
4. **Bonus 1 (`/random`)** : Retourne une chanson alÃ©atoire du hit-parade.
5. **Bonus de la mort (`/total-vues`)** : Affiche le nombre total de vues de toutes les chansons.

---

### **ğŸ¯ Objectif du Challenge**

CrÃ©er un **serveur Express** qui :

+ Affiche des pages statiques avec du texte.
+ GÃ¨re des **compteurs de vues** pour les statistiques.
+ Utilise un **module externe** (`HitParade.js`) pour stocker les donnÃ©es du hit-parade.

---

### **ğŸ“Œ Ã‰tapes Ã  RÃ©aliser**

#### **1ï¸âƒ£ Installation dâ€™Express et Configuration du Projet**

**Objectif :** Initialiser un projet Node.js avec Express et configurer le `package.json` pour utiliser les modules ES6.

**Mon code :**
*(InsÃ©rer ici ton bloc de code pour lâ€™initialisation du projet et lâ€™installation dâ€™Express. Par exemple :)*

```bash
# Initialiser le projet et installer Express
npm init -y
npm install express
```

**Modifier le `package.json` pour utiliser les modules ES6 :**

```json
{
  "name": "hit-machine-express",
  "version": "1.0.0",
  "type": "module",  // Ajouter cette ligne pour utiliser import/export
  "scripts": {
    "start": "node index.js",
    "dev": "node --watch index.js"
  },
  "dependencies": {
    "express": "^4.18.2"
  }
}
```

---

#### **2ï¸âƒ£ CrÃ©ation du Module `HitParade.js`**

**Objectif :** Stocker les donnÃ©es du hit-parade dans un module externe pour une meilleure organisation.

**Mon code :**
*(InsÃ©rer ici ton bloc de code pour le module `HitParade.js`. Par exemple :)*

```javascript
// HitParade.js
const hitParade = [
  {
    position: 1,
    artist: "Coldplay",
    title: "Viva La Vida",
    views: 1000000
  },
  {
    position: 2,
    artist: "Daft Punk",
    title: "Get Lucky",
    views: 950000
  },
  {
    position: 3,
    artist: "Ed Sheeran",
    title: "Shape of You",
    views: 900000
  },
  {
    position: 4,
    artist: "The Weeknd",
    title: "Blinding Lights",
    views: 850000
  },
  {
    position: 5,
    artist: "Kids United",
    title: "On Ã©crit sur les murs",
    views: 800000
  },
  {
    position: 6,
    artist: "Indochine",
    title: "J'ai demandÃ© Ã  la lune",
    views: 750000
  },
  {
    position: 7,
    artist: "Stromae",
    title: "Alors on danse",
    views: 700000
  },
  {
    position: 8,
    artist: "David Guetta",
    title: "Titanium",
    views: 650000
  },
  {
    position: 9,
    artist: "M. Pokora",
    title: "Juste une photo de toi",
    views: 600000
  },
  {
    position: 10,
    artist: "Louane",
    title: "Avenir",
    views: 550000
  }
];

// Exporter le hit-parade et une fonction pour obtenir une chanson alÃ©atoire
export { hitParade };

// Fonction pour obtenir une chanson alÃ©atoire (pour le bonus)
export function getRandomSong() {
  const randomIndex = Math.floor(Math.random() * hitParade.length);
  return hitParade[randomIndex];
}

// Fonction pour calculer le total de vues (pour le bonus de la mort)
export function getTotalViews() {
  return hitParade.reduce((total, song) => total + song.views, 0);
}
```

---

#### **3ï¸âƒ£ CrÃ©ation du Serveur Express et Test Initial**

**Objectif :** CrÃ©er un serveur Express basique et tester son fonctionnement avec un "Hello, World!".

**Mon code :**
*(InsÃ©rer ici ton bloc de code pour le serveur Express initial. Par exemple :)*

```javascript
// index.js
import express from 'express';
import { hitParade, getRandomSong, getTotalViews } from './HitParade.js';

const app = express();
const port = 3000;

// Variable pour compter les visites de la page d'accueil
let homePageViews = 0;

// Route pour la page d'accueil
app.get('/', (req, res) => {
  homePageViews++;
  res.send('Je m\'appelle Charlu, je m\'appelle Lili, vous Ãªtes chez O\'clock.');
});

// DÃ©marrer le serveur
app.listen(port, () => {
  console.log(`Server running at http://localhost:${port}`);
});
```

---

#### **4ï¸âƒ£ CrÃ©ation de la Page de Classement (`/classement`)**

**Objectif :** Afficher le classement du hit-parade sous forme de texte.

**Mon code :**
*(InsÃ©rer ici ton bloc de code pour la route `/classement`. Par exemple :)*

```javascript
// Route pour afficher le classement
app.get('/classement', (req, res) => {
  let classementText = "<h1>Top 10 du Hit-Parade</h1><ul>";
  hitParade.forEach(song => {
    classementText += `<li>${song.position}. ${song.title} - ${song.artist} (${song.views} vues)</li>`;
  });
  classementText += "</ul>";
  res.send(classementText);
});
```

---

#### **5ï¸âƒ£ CrÃ©ation de la Page de Statistiques (`/stats`)**

**Objectif :** Afficher le nombre de visites de la page dâ€™accueil.

**Mon code :**
*(InsÃ©rer ici ton bloc de code pour la route `/stats`. Par exemple :)*

```javascript
// Route pour afficher les statistiques
app.get('/stats', (req, res) => {
  res.send(`La chanson de Charli Lulu a Ã©tÃ© vue ${homePageViews} fois !`);
});
```

---

#### **6ï¸âƒ£ Bonus 1 : Route `/random` pour une Chanson AlÃ©atoire**

**Objectif :** Retourner une chanson alÃ©atoire du hit-parade.

**Mon code :**
*(InsÃ©rer ici ton bloc de code pour la route `/random`. Par exemple :)*

```javascript
// Route pour afficher une chanson alÃ©atoire
app.get('/random', (req, res) => {
  const randomSong = getRandomSong();
  res.send(`ğŸµ Chanson alÃ©atoire : ${randomSong.title} - ${randomSong.artist} (Position ${randomSong.position})`);
});
```

---

#### **7ï¸âƒ£ Bonus de la Mort : Route `/total-vues` pour le Total de Vues**

**Objectif :** Calculer et afficher le nombre total de vues de toutes les chansons.

**Mon code :**
*(InsÃ©rer ici ton bloc de code pour la route `/total-vues`. Par exemple :)*

```javascript
// Route pour afficher le total de vues
app.get('/total-vues', (req, res) => {
  const total = getTotalViews();
  res.send(`ğŸ‘€ Total de vues pour toutes les chansons : ${total}`);
});
```

---

### **ğŸ–¥ï¸ Rendu Final du Site Web**

*(InsÃ©rer ici des captures dâ€™Ã©cran ou des exemples de sortie pour chaque route :)*

1. **Page dâ€™accueil (`/`)** :
   ```
   Je m'appelle Charlu, je m'appelle Lili, vous Ãªtes chez O'clock.
   ```

2. **Page de classement (`/classement`)** :
   ```
   Top 10 du Hit-Parade
   â€¢ 1. Viva La Vida - Coldplay (1000000 vues)
   â€¢ 2. Get Lucky - Daft Punk (950000 vues)
   â€¢ ...
   ```

3. **Page de statistiques (`/stats`)** :
   ```
   La chanson de Charli Lulu a Ã©tÃ© vue 42 fois !
   ```

4. **Route alÃ©atoire (`/random`)** :
   ```
   ğŸµ Chanson alÃ©atoire : On Ã©crit sur les murs - Kids United (Position 5)
   ```

5. **Total de vues (`/total-vues`)** :
   ```
   ğŸ‘€ Total de vues pour toutes les chansons : 7400000
   ```

---

### **ğŸ’¡ Ce Que Jâ€™ai Appris avec ce Challenge**

1. **Structurer un projet Express** : Utiliser des modules externes (`HitParade.js`) pour organiser les donnÃ©es.
2. **CrÃ©er des routes dynamiques** : RÃ©pondre Ã  diffÃ©rentes URLs avec des contenus spÃ©cifiques.
3. **GÃ©rer un Ã©tat simple** : Utiliser une variable (`homePageViews`) pour compter les visites.
4. **Exporter/importer des fonctions** : RÃ©utiliser la logique (ex: `getRandomSong`) dans plusieurs routes.
5. **Bonus : Manipuler des donnÃ©es** : Calculer des totaux ou sÃ©lectionner des Ã©lÃ©ments alÃ©atoires dans un tableau.
