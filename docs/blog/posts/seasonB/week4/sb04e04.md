---
date:
  created: 2025-11-27

draft: true
---

# **ğŸ“… SAISON B Semaine 4 Ã‰pisode 4 - Projet en autonomie Jour 2 - Structuration MVC et Dynamisation des Pages**

## **ğŸ“š Introduction**

DeuxiÃ¨me jour de travail sur le projet **oCoffee** ! Aujourdâ€™hui, jâ€™ai avancÃ© sur la **structuration de lâ€™architecture MVC** et la **dynamisation des pages**. Mon objectif Ã©tait de rendre les pages du site fonctionnelles de maniÃ¨re statique, puis de commencer Ã  les dynamiser avec des donnÃ©es JSON. Voici le bilan de la journÃ©e.

<!-- more -->

---

## **Ã‰tape 1 : Structuration de lâ€™architecture MVC**

### **Contexte**

Les vues pour la **page dâ€™accueil** et le **catalogue** Ã©taient dÃ©jÃ  fournies dans le dossier dâ€™intÃ©gration du projet, avec leurs styles CSS respectifs. Mon travail a consistÃ© Ã  :

1. **CrÃ©er les vues manquantes** (page de dÃ©tail dâ€™un cafÃ© et page de prÃ©sentation de la boutique).
2. **Configurer les routes et contrÃ´leurs** pour chaque page.

### **Actions rÃ©alisÃ©es**

+ **CrÃ©ation des wireframes** pour les pages manquantes :
  + **Page de dÃ©tail dâ€™un cafÃ©** : Affichage des informations spÃ©cifiques (nom, origine, prix, caractÃ©ristiques, etc.).
  + **Page "OÃ¹ nous trouver ?"** : IntÃ©gration dâ€™une carte interactive (OpenStreetMap) et des coordonnÃ©es de la boutique.

+ **DÃ©veloppement des vues EJS** :
  + `coffee-detail.ejs` pour la page de dÃ©tail dâ€™un cafÃ©.
  + `find-us.ejs` pour la page de prÃ©sentation de la boutique.

+ **CrÃ©ation des routes et contrÃ´leurs** :
  + `coffeeRoutes.js` et `coffeeController.js` pour gÃ©rer les requÃªtes liÃ©es aux cafÃ©s.
  + `findUsRoutes.js` et `findUsController.js` pour la page de localisation.

---

## **Ã‰tape 2 : Dynamisation des pages avec des donnÃ©es JSON**

### **Objectif**

Avant de me connecter Ã  une base de donnÃ©es PostgreSQL, jâ€™ai dÃ©cidÃ© de **simuler une base de donnÃ©es** avec un fichier JSON contenant un Ã©chantillon de donnÃ©es sur les cafÃ©s. Cela me permet de tester le rendu dynamique des pages sans dÃ©pendre dâ€™une base de donnÃ©es.

### **Actions rÃ©alisÃ©es**

+ **CrÃ©ation du fichier `data/coffees.json`** :

  ```json
  {
    "coffees": [
      {
        "reference": "100955890",
        "name": "Espresso",
        "description": "CafÃ© fort et concentrÃ©...",
        "origin": "Italie",
        "price_per_kg": 20.99,
        "available": true,
        "characteristics": ["CorsÃ©", "Ã‰picÃ©"]
      },
      // ... (autres cafÃ©s)
    ]
  }
  ```

+ **IntÃ©gration des donnÃ©es JSON dans les contrÃ´leurs** :

  ```javascript
  // Dans coffeeController.js
  const coffeesData = require('../../data/coffees.json');

  exports.getAllCoffees = (req, res) => {
    res.render('coffees', { coffees: coffeesData.coffees });
  };

  exports.getCoffeeByReference = (req, res) => {
    const coffee = coffeesData.coffees.find(c => c.reference === req.params.reference);
    res.render('coffee-detail', { coffee });
  };
  ```

+ **Affichage dynamique dans les vues EJS** :

  ```html
  <!-- Dans coffee-detail.ejs -->
  <h1><%= coffee.name %></h1>
  <p><%= coffee.description %></p>
  <p>Origine : <%= coffee.origin %></p>
  ```

---

## **Ã‰tape 3 : RÃ©solution dâ€™un bug dâ€™affichage**

### **ProblÃ¨me rencontrÃ©**

En testant la page de dÃ©tail dâ€™un cafÃ©, jâ€™ai rencontrÃ© une erreur dans la console :

```bash
Refused to apply style from '<URL>' because its MIME type ('text/html') is not a supported stylesheet MIME type, and strict MIME checking is enabled.
```

### **Diagnostic**

Cette erreur indiquait que le navigateur refusait dâ€™appliquer le fichier CSS car il ne le reconnaissait pas comme une feuille de style. AprÃ¨s investigation, jâ€™ai rÃ©alisÃ© que le problÃ¨me venait des **chemins des fichiers statiques** dans ma vue EJS.

### **Solution**

Dans le fichier dâ€™intÃ©gration HTML fourni, les chemins vers les fichiers CSS Ã©taient sous la forme `../css/style.css`. Or, avec EJS et Express, les fichiers statiques doivent Ãªtre rÃ©fÃ©rencÃ©s depuis le dossier `public/` avec un chemin absolu :

```html
<!-- Correction dans coffee-detail.ejs -->
<link rel="stylesheet" href="/css/style.css">
```

Une fois cette correction effectuÃ©e, le style sâ€™est appliquÃ© correctement.

---

## **Bilan de la journÃ©e**

### **Ce qui a bien fonctionnÃ©**

âœ… **Structuration MVC** : Les routes, contrÃ´leurs et vues sont maintenant bien organisÃ©s.
âœ… **Dynamisation des pages** : Les donnÃ©es JSON sont correctement intÃ©grÃ©es et affichÃ©es.
âœ… **RÃ©solution du bug** : Jâ€™ai compris lâ€™importance des chemins des fichiers statiques dans un projet Express.

### **DifficultÃ©s rencontrÃ©es**

âš ï¸ **Chemins des fichiers statiques** : Une erreur simple mais qui mâ€™a fait perdre du temps.
âš ï¸ **IntÃ©gration de Leaflet** : Jâ€™ai dÃ» me familiariser avec la bibliothÃ¨que pour afficher la carte OpenStreetMap.

### **Objectifs pour demain**

ğŸ”¹ **CrÃ©ation de la base de donnÃ©es PostgreSQL** :

+ ImplÃ©menter le MPD crÃ©Ã© hier.
+ Connecter lâ€™application Express Ã  la base de donnÃ©es.

ğŸ”¹ **Remplacer les donnÃ©es JSON par des requÃªtes SQL** :

+ Utiliser `pg` pour interagir avec PostgreSQL.
+ Mettre Ã  jour les contrÃ´leurs pour rÃ©cupÃ©rer les donnÃ©es depuis la base.

---

## **Conclusion**

Cette deuxiÃ¨me journÃ©e a Ã©tÃ© **intense mais trÃ¨s formatrice**. Jâ€™ai pu appliquer les concepts MVC, dynamiser mes pages et rÃ©soudre des problÃ¨mes techniques. Demain, je passe Ã  lâ€™Ã©tape cruciale de la **base de donnÃ©es** !
